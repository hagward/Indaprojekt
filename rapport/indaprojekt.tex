\documentclass[11pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[swedish]{babel}
\usepackage{fancyhdr}

\author{Anders Hagward \and Fredrik Hillnertz}
\title{Slutprojekt}

\pagestyle{fancy}
\fancyhead{}
\fancyfoot{}
\chead{Slutrapport för Breakout}
\cfoot{\thepage}

\begin{document}

\thispagestyle{empty}
\begin{center}
\Huge Slutrapport för Breakout \\
\Large Introduktion till Datalogi \\
\normalsize Anders Hagward och Fredrik Hillnertz
\end{center}
\newpage

\tableofcontents
\newpage

\section{Programbeskrivning}

\subsection{A}
Programmet skall underhålla och stjäla tid från användaren. Detta genom att låta denne styra ett racket för att upprepade gånger studsa en boll mot ett antal förstörbara block. Lär även vara gynnsamt för användarens pricksäkerhet och reflexer.

\subsection{B}
Programmet har lyckats uppfylla A, men erbjuder också så kallade ``power ups'' som ändrar spelupplevelsen under spelets gång och således kan verka ännu bättre för att skärpa användarens sinnen. Det kan till exempel röra sig om att bollen åker fortare eller långsammare, dödliga dödskallar som faller från skyn, extrabollar som gör entré eller liknande.

\subsection{C}
Egentligen är det inga direkta skillnader mellan programbeskrivningarna. ``Power ups'':en gör bara att användaren får koncentrera sig ännu mer än beräknat för att inte gå hädan, samt att spelet (förmodligen) är ännu bättre på att underhålla och själa tid.

\section{Användarbeskrivning}

\subsection{A}
Användaren förutsätts ha ``lagom'' datorvana, det vill säga vetskap om hur man startar en dator, kör ett program och interagerar med mus och tangentbord. En ungefärlig åldersskala är 6-60 år. Användaren bör även ha grundläggande kunskaper i det engelska språket då menyerna och hjälpavsnittet är på engelska.

\subsection{B, C}
Användarbeskrivningen har ej ändrats.

\section{Användarscenarier}

\subsection{A}
Nedan följer två vanliga scenarier.

\subsubsection{Scenario I}
\begin{enumerate}
	\item Användaren startar programmet och möts av en huvudmeny med menyvalen \emph{New game}, \emph{Settings}, \emph{Help} och \emph{Quit}.
	\item Användaren väljer det första alternativet och en ny vy framställs på skärmen. Denna består av ett racket längst ned som går att styra med musen, en boll fastsittandes mitt på racketet, en hord av förstörbara block längst upp samt solida väggar och tak.
	\item Användaren trycker på vänster musknapp och får bollen att fara iväg uppåt, studsandes mot blocken, väggarna och taket.
	\item Blocken försvinner successivt i och med att bollen studsar på dem.
	\item Alla block har slutligen försvunnit och användaren vinner spelet.
	\item En ny 'karta' presenteras (det vill säga, blocken är uppställda i en annan formation än tidigare).
	\item Användaren väljer att avsluta spelet genom att trycka \texttt{Esc} för att få upp spelmenyn och sedan välja \emph{Quit}.
\end{enumerate}

\subsubsection{Scenario II}
\begin{enumerate}
	\item Användaren startar programmet och möts av samma huvudmeny som i föregående scenario.
	\item Användaren väljer menyvalet \emph{Help} och får reda på information om hur spelet fungerar.
	\item Användaren backar tillbaka till huvudmenyn genom att trycka \texttt{Esc}.
	\item Användaren väljer menyvalet \emph{Settings} och väljer att stänga av ljudet.
	\item Användaren backar återigen till huvudmenyn på samma vis som tidigare men väljer nu \emph{New game}.
	\item Samma spelvy som i föregående scenario visas och användaren spelar på samma sätt.
	\item Användaren är inte så pricksäker och lyckas inte få bollen att studsa på racketet. För varje gång han missar förlorar han ett 'liv'.
	\item Användaren förlorar tre liv och därmed även spelet.
	\item En meny med valen \emph{Play again}, \emph{Settings}, \emph{Help} och \emph{Quit} visas. Användaren väljer det sistnämnda.
\end{enumerate}

\subsection{B}
Nedan följer de två scenarierna från A, fast som de slutligen blev.

\subsubsection{Scenario I}
\begin{enumerate}
	\item Användaren startar programmet och möts av en huvudmeny med menyvalen \emph{New game}, \emph{High Score}, \emph{Settings}, \emph{Help} och \emph{Quit}.
	\item Användaren väljer det första alternativet och en ny vy framställs på skärmen. Denna består av ett racket längst ned som går att styra med musen, en boll fastsittandes mitt på racketet samt en hord av förstörbara block längst upp.
	\item Användaren trycker på vänster musknapp och får bollen att fara iväg uppåt, studsandes mot blocken, väggarna och taket.
	\item Blocken försvinner successivt i och med att bollen studsar på dem.
	\item Alla block har slutligen försvunnit och användaren har därmed besegrat den nuvarande 'kartan'.
	\item En ny karta presenteras (det vill säga, blocken är uppställda i en annan formation än tidigare).
	\item Användaren väljer att avsluta spelet genom att trycka \texttt{Esc} för att få upp spelmenyn, välja \emph{Back to Main Menu} för att komma till huvudmenyn och där välja \emph{Quit} igen för att avsluta spelet.
\end{enumerate}

\subsubsection{Scenario II}
\begin{enumerate}
	\item Användaren startar programmet och möts av samma huvudmeny som i föregående scenario.
	\item Användaren väljer menyvalet \emph{Help} och får reda på information om hur spelet fungerar.
	\item Användaren backar tillbaka till huvudmenyn genom att trycka med musen på knappen \texttt{Back}.
	\item Användaren väljer menyvalet \emph{Settings} och väljer att stänga av ljudet.
	\item Användaren backar återigen till huvudmenyn på samma vis som tidigare men väljer nu \emph{New game}.
	\item Samma spelvy som i föregående scenario visas och användaren spelar på samma sätt.
	\item Användaren är inte så pricksäker och lyckas inte få bollen att studsa på racketet. För varje gång han missar förlorar han ett 'liv'.
	\item Användaren förlorar tre liv och därmed även spelet.
	\item En meny med valen \emph{Play Again} och \emph{Back to Main Menu} visas. Användaren väljer det sistnämnda för att komma tillbaka till huvudmenyn, och väljer där återigen \emph{Quit} för att avsluta spelet.
\end{enumerate}

\subsection{C}
För det första så är huvudmenyn utökad med ännu ett alternativ, nämligen \emph{High Score} som föga förvånande tar spelaren till listan över de högsta uppnådda poängen (detta gäller båda scenarierna). Den andra märkbara skillnaden är att \emph{Back to Main Menu}-alternativet i den så kallade ``in game''-menyn som tar spelaren tillbaka till huvudmenyn har ersatt \emph{Quit}-alternativet, som skulle avslutat hela programmet (gäller också båda scenarierna). De två sista delarna som skiljer sig återfinns i Scenario II och är att man inte 'backar' i menyerna med \texttt{Esc}-knappen samt att alternativen som visas när man förlorat är färre.

\section{Testplan}

\subsection{A}
Förutom de två scenarierna ovan kommer menyerna testas ordentligt, så alla menyval fungerar korrekt. Inställningsmöjligheterna kommer testas, så att ljudeffekterna verkligen försvinner när man gör den inställningen, och verkligen kommer tillbaka om man gör inställningen igen.

Själva spelmekaniken kommer givetvis testas grundligt så att inte bollen verkligen studsar mot väggarna, taken, blocken och racketet, så att blocken försvinner vid kontakt med bollen, så att ett 'liv' försvinner och att bollen återställs på racketet vid varje 'miss'. Vidare skall testas så att rätt meny med fungerande menyval dyker upp vid förlorat spel, så att en ny bana laddas när alla block är borta, så att en poänglista visas när man klarat alla fem banor och att den nya poängen sparas.

Självklart skall spelet testas av en tredjepart.

\subsection{B}
Vid det första användartestet läts en kille i 20-årsåldern med god datorvana testa spelet. Han provade samtliga olika menyalternativ, och kollade även snabbt igenom hjälptexten med kontrollerna, innan han startade ett nytt spel. Väl igång fick han i uppdrag att få ett poäng högre än 100,000 och komma med på highscorelistan, någonting han inte hade några problem att klara av.
Vi noterade dock följande saker under spelets gång:

\begin{itemize}
	\item Han kunde inte lista ut vad ``fireball''-powerup:en gjorde enbart baserat på dess ikon.
	\item Poängen skall långsamt räkna ned hela tiden för att motivera spelaren att klara av kartorna så fort som möjligt, men ibland slutade den helt plötsligt med detta vilket förvirrade testpersonen. En bugg funnen med andra ord.
	\item Han skulle mitt i spelet pausa spelet genom att öppna ``in game''-menyn, vilket han misslyckades med då en sådan inte var implementerad vid testtillfället. Vi noterade dock att han försökte få fram den genom att trycka på \texttt{Esc}-tangenten utan att det var förklarat någonstans vilket indikerar på bra val av tangent.
	\item När han klarat alla banor och skulle ange sitt namn poppade inmatningsdialogen upp i \emph{bakgrunden} istället för längst fram vilket gjorde att spelet först såg ut att ha kraschat. Testpersonen insåg dock snabbt vad som hade hänt -- datorvan som han är -- och letade upp inmatningsrutan.
	\item Medan dialogen för inmatning av namn var uppe fick han syn på att det i spelet stod att han fortfarande hade ett liv kvar vilket han snabbt påpekade. Det visade sig att texten inte uppdaterar sig sista gången vilket kan skapa förvirring.
\end{itemize}

Den andre testpersonen var också en datorvan typ i 20-årsåldern. Liksom testperson nummer ett försökte han få upp en meny medan han spelade, vilket konstaterats inte fungerar än, men han kommenterade även följande:

\begin{itemize}
	\item Han tyckte det var svårt att gissa vad de olika powerups:en gjorde.
	\item Det var oklart när han kunde skjuta laser eller inte.
	\item När det blev många objekt på skärmen -- många bollar och powerup:s i rörelse -- tenderade det att bli rörigt, och svårt att snabbt avgöra vilka powerup:s att ta och vilka att låta bli.
\end{itemize}

\subsection{C}
Skillnaden mellan den planerade testningen och den utförda är marginella. Den enda egentliga är att uppdraget ``få mer än 100,000 poäng'' lades till vid det första användartestet för att motivera användaren.

Användartestningen har dock givit oss en hel del värdefull information om hur spelet kan förbättras:

\begin{itemize}
	\item Vi har insett att det kan vara en bra idé att förklara vad de olika powerups:en gör i hjälpmenyn, så att användaren kan känna igen dem och ha ett hum om vad de gör när spelet väl är igång.
	\item Indikationen på att man kan skjuta laser kan göras tydligare.
	\item De upptäckta buggarna skall lösas.
\end{itemize}

\section{Programdesign}

\subsection{A}
Programmet kommer bygga på spelbiblioteket \emph{Slick}. Nedan följer en lista på de grundläggande klasserna och dess viktigaste metoder.

\begin{itemize}
	\item \texttt{MainMenuState, GameplayState}: Då biblioteket Slick använder sig av så kallade \emph{states}, eller \emph{tillstånd}, kommer minst två 'state'-klasser implementeras. Deras viktigaste metoder är \texttt{init}, där alla bilder och ljud laddas, \texttt{render} där allt ritas upp på skärmen och \texttt{update} där alla beräkningar sker (för kollisioner, positionsuppdateringar med mera).
	\item \texttt{GameObject}: En abstrakt klass som representerar ett objekt på skärmen. Viktigaste metoder: \texttt{getImage, setImage} som hanterar objektets bild, \texttt{getXPos, getYPos} returnerar objektets position.
	\item \texttt{Ball, Block, Racket}: Klasser som ärver \texttt{GameObject}.
	\item \texttt{Movable}: Ett interface med metoden \texttt{move}, där implementerande klasser får beskriva hur objektets position skall uppdateras.
	\item \texttt{Highscore}: Sköter all skrivning och läsning till och från textfilen där poängen sparas. Viktigaste metoder är \texttt{addScore} som lägger till ett poäng, \texttt{getScores} som returnerar en lista med poängen.
	\item \texttt{BreakoutGame}: 'Huvudklassen' som innehåller \texttt{main}-metoden.
\end{itemize}

\subsection{B}
Vi höll oss till biblioteket Slick, men klasstrukturen skiljer sig en del från den ursprungligen planerade:

\begin{itemize}
	\item \texttt{MainMenuState, GameplayState, HighScoreState}: Se motsvarande förklaring i A-delen.
	\item \texttt{LevelHandler}: Har hand om allt som rör kartorna; ladda in en karta från en fil och hålla koll på alla objekt på den (som bollar, block och så vidare).
	\item \texttt{Ball, Block, Racket, PowerUp}: Klasser som representerar synliga spelobjekt. Alla dessa ärver Slick-klassen \texttt{Shape} på ett eller annat sätt, samt implementerar gränssnittet \texttt{Movable} för att kunna röra på sig. Förutom de positionsrelaterade metoderna ärvda från \texttt{Shape} har de den viktiga metoden \texttt{draw}, som ritar ut objektet på rätt plats på skärmen.
	\item \texttt{Movable}: Ett interface med metoden \texttt{move}, där implementerande klasser får beskriva hur objektets position skall uppdateras.
	\item \texttt{HighscoreHandler, Score}: Den förstnämnda har hand om själva highscorelistan, och att läsa och skriva den till en fil. Varje poäng representeras av ett \texttt{Score}-objekt, som innehåller poängen samt namnet på spelaren som uppnått dem.
	\item \texttt{Player}: Representerar spelaren med ett namn, hur många liv spelaren har kvar samt dennes poäng.
	\item \texttt{SoundPlayer}: Sköter uppspelning av ljud. Har en metod för varje ljud som används i spelet.
	\item \texttt{ResourceLoader}: Laddar in alla bilder för snabb åtkomst. Har den ovärderliga metoden \texttt{load} som gör detta.
	\item \texttt{BreakoutGame}: 'Huvudklassen' som innehåller \texttt{main}-metoden.
\end{itemize}

\subsection{C}
De huvudsakliga skillnaderna i punktform:

\begin{itemize}
	\item Ett så kallat 'state' lades till, nämligen \texttt{HighScoreState} som presenterar poänglistan.
	\item Klassen \texttt{LevelHandler} skapades för att ha hand om allt som rör kartorna.
	\item Så kallade ``power ups'' lades till i spelet, där varje sådan representeras av ett \texttt{PowerUp}-objekt.
	\item Den abstrakta klassen \texttt{GameObject} togs helt bort och ersattes med Slick-bibliotekets \texttt{Shape}-underklasser, detta för att göra kollisionsdetekteringen mer solid.
	\item Den tänkta klassen \texttt{Highscore} förkastades och istället skapades \texttt{HighScoreHandler} samt \texttt{Score}.
	\item Klassen \texttt{Player} skapades för att representera spelaren.
	\item Klassen \texttt{SoundPlayer} skapades för ljuduppspelning.
	\item Klassen \texttt{ResourceLoader} skapades för bildinladdning.
\end{itemize}

\section{Tekniska frågor}

\subsection{A}
Nedan följer en lista med tänkbara tekniska problem och eventuella lösningar.
\begin{description}
	\item[Problem:] Vid eventuellt bildbyte på objekt medan spelet körs (till exempel om ett block kräver flera bollstudsar för att försvinna) skulle en viss fördröjning kunna uppstå innan programmet har läst in den nya bilden. \textbf{Ev. lösning:} Ladda in flera bilder för ett objekt vid initiering?
	\item[Problem:] Hur 'kartorna' skall representeras. \textbf{Ev. lösning:} Läsa in dem från filer?
	\item[Problem:] Exakt vilka klasser som skall finnas och vad var och en skall sköta i spelet, samt undvika att skapa klasser det redan finns motsvarigheter till i spelbiblioteket. \textbf{Ev. lösning:} Träna objektorientering, tänka efter ordentligt och läsa bibliotekets dokumentation.
	\item[Problem:] Hur skall programmet bete sig om någon väsentlig fil saknas? \textbf{Ev. lösning:} Ljudfil - meddela användaren, highscorefil - skapa en ny fil utan att meddela användaren, kartfil eller bildfil - meddela användaren och avsluta.
\end{description}

\subsection{B}
\begin{description}
	\item[Problem:] Vid eventuellt bildbyte på objekt medan spelet körs (till exempel om ett block kräver flera bollstudsar för att försvinna) skulle en viss fördröjning kunna uppstå innan programmet har läst in den nya bilden. \textbf{Löstes så här:} Klassen \texttt{ResourceLoader} skapades som vid programstart får ladda in samtliga bilder för att ha dem i beredskap.
	\item[Problem:] Hur 'kartorna' skall representeras. \textbf{Löstes så här:} Kartorna skapades med hjälp av programmet \emph{Tiled Map Editor} (http://www.mapeditor.org/), och informationen om dem sparades i XML-format. För att ladda en bana läses bara dess respektive XML-fil in och \texttt{Block}-objekt skapas efter informationen i filen.
	\item[Problem:] Exakt vilka klasser som skall finnas och vad var och en skall sköta i spelet, samt undvika att skapa klasser det redan finns motsvarigheter till i spelbiblioteket. \textbf{Löstes så här:} Själva konceptet 'objektorientering' har vi fått träna på allteftersom arbetet fortskridit för att inte koden skall bli alltför gräslig. Slicks dokumentation har studerats mer eller mindre som planerat.
	\item[Problem:] Hur skall programmet bete sig om någon väsentlig fil saknas? \textbf{Löstes så här:} Ljudfil - meddela användaren, highscorefil - skapa en ny fil utan att meddela användaren, kartfil eller bildfil - meddela användaren och avsluta.
	\item[Problem:] Hur skall vi få spelet att köras lika snabbt på olika kraftfulla datorer? \textbf{Löstes så här:} Använde metoderna \texttt{setMinimumLogicUpdateInterval} och \texttt{setMaximumLogicUpdateInterval} från Slick-klassen \texttt{GameContainer} för att precisera uppdateringsintervallet.
\end{description}

\subsection{C}
Det 'enda' större fundamentala problemet som stöttes på som inte tagits med i projektplanen var det sista i listan i B-sektionen; nämligen hur man skulle få spelet att köras lika snabbt vare sig datorn i fråga är av modellen snabbare eller långsammare.

\section{Arbetsplan}

\subsection{A}
Arbetet kommer delas upp på det viset att var och en får några bestämda klasser att implementera. De skall implementeras efter en specifikation som bestäms i förväg så att båda har koll på vad de gör och vad de skall användas till. Om eventuella problem skulle uppstå och en fastnar med någon del av implementationen kan givetvis den andre hjälpa till.

Arbetsplanen är upplagd på följande vis:

\begin{description}
	\item[7 - 14 april:] Nödvändiga klasser skall skapas och grundläggande spelmekanik implementeras. Spelet skall vara 'minimalt' spelbart, det vill säga att racketet skall kunna styras och bollen skall studsa korrekt mot de övriga objekten.
	\item[15 - 22 april:] I första hand skall spelmekaniken putsas på. I andra hand skall ljud, poängsystem, inställningsmeny och hjälpmeny implementeras (så många som hinns med).
	\item[23 - 30 april:] Slutrapporten skall skrivas och eventuell putsning av spelet skall göras inför prototypvisning.
	\item[1 - 7 maj:] Eventuell implementation av detaljer som inte hunnits med samt finputsning.
\end{description}

\subsection{B}
Vi låg i fas med den förbestämda arbetsplanen i princip genom hela arbetet. Uppdelningen skedde spontant allt eftersom vad vi kände för att göra och vad som behövde göras. I stora drag hade Anders hand om menyerna, kollisionshanteringen och poängsystemet, medan Fredrik fixade ``power ups'':en och kartorna.

\subsection{C}
Då arbetsplanen inte behövde ändras är det ingen skillnad mellan A och B.

\section{Sammanfattning}
Vi har lärt oss mycket av projektet, här är de viktigaste punkterna:

\begin{description}
	\item[Versionshantering] Då vi använde programmet \emph{Git} för att hålla ordning på alla uppdateringar som gjordes har vi fått lära oss (grundläggande) om hur den typen av mjukvara fungerar och hur det är att arbeta tillsammans på ett projekt.
	\item[Tredjepartsbibliotek] Som nämnt tidigare i texten användes spelbiblioteket \emph{Slick} vilket har gjort oss tvungna att ta reda på hur man importerar ett tredjepartsbibliotek i Java (eller kanske främst hur det går till med utvecklingsverktyget \emph{Eclipse}) samt gräva i dokumentationen för att få ett hum om hur det är uppbyggt.
	\item[Planering] Vi har noterat att koden lätt svämmar över alla bredder om man inte sköter om den med jämna mellanrum, och framför allt har en tydlig bild om hur strukturen skall se ut. Att försöka hålla klasserna \emph{löst kopplade} och undvika redundans är nödvändigt för att enklare kunna bygga ut och ändra i projektet. Detta är någonting vi kunde löst på bättre vis.
\end{description}

\end{document}